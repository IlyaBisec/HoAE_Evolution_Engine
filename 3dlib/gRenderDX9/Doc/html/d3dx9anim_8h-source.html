<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>gRenderDX9: d3dx9anim.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<h1>d3dx9anim.h</h1><div class="fragment"><pre>00001 
00002 <span class="comment">//</span>
00003 <span class="comment">//  Copyright (C) Microsoft Corporation.  All Rights Reserved.</span>
00004 <span class="comment">//</span>
00005 <span class="comment">//  File:       d3dx9anim.h</span>
00006 <span class="comment">//  Content:    D3DX mesh types and functions</span>
00007 <span class="comment">//</span>
00009 <span class="comment"></span>
00010 <span class="preprocessor">#ifndef __D3DX9ANIM_H__</span>
00011 <span class="preprocessor"></span><span class="preprocessor">#define __D3DX9ANIM_H__</span>
00012 <span class="preprocessor"></span>
00013 <span class="comment">// {698CFB3F-9289-4d95-9A57-33A94B5A65F9}</span>
00014 DEFINE_GUID(IID_ID3DXAnimationSet, 
00015 0x698cfb3f, 0x9289, 0x4d95, 0x9a, 0x57, 0x33, 0xa9, 0x4b, 0x5a, 0x65, 0xf9);
00016 
00017 <span class="comment">// {FA4E8E3A-9786-407d-8B4C-5995893764AF}</span>
00018 DEFINE_GUID(IID_ID3DXKeyframedAnimationSet, 
00019 0xfa4e8e3a, 0x9786, 0x407d, 0x8b, 0x4c, 0x59, 0x95, 0x89, 0x37, 0x64, 0xaf);
00020 
00021 <span class="comment">// {6CC2480D-3808-4739-9F88-DE49FACD8D4C}</span>
00022 DEFINE_GUID(IID_ID3DXCompressedAnimationSet, 
00023 0x6cc2480d, 0x3808, 0x4739, 0x9f, 0x88, 0xde, 0x49, 0xfa, 0xcd, 0x8d, 0x4c);
00024 
00025 <span class="comment">// {AC8948EC-F86D-43e2-96DE-31FC35F96D9E}</span>
00026 DEFINE_GUID(IID_ID3DXAnimationController, 
00027 0xac8948ec, 0xf86d, 0x43e2, 0x96, 0xde, 0x31, 0xfc, 0x35, 0xf9, 0x6d, 0x9e);
00028 
00029 
00030 <span class="comment">//----------------------------------------------------------------------------</span>
00031 <span class="comment">// D3DXMESHDATATYPE:</span>
00032 <span class="comment">// -----------------</span>
00033 <span class="comment">// This enum defines the type of mesh data present in a MeshData structure.</span>
00034 <span class="comment">//----------------------------------------------------------------------------</span>
00035 <span class="keyword">typedef</span> <span class="keyword">enum</span> _D3DXMESHDATATYPE {
00036     D3DXMESHTYPE_MESH      = 0x001,             <span class="comment">// Normal ID3DXMesh data</span>
00037     D3DXMESHTYPE_PMESH     = 0x002,             <span class="comment">// Progressive Mesh - ID3DXPMesh</span>
00038     D3DXMESHTYPE_PATCHMESH = 0x003,             <span class="comment">// Patch Mesh - ID3DXPatchMesh</span>
00039 
00040     D3DXMESHTYPE_FORCE_DWORD    = 0x7fffffff,   <span class="comment">/* force 32-bit size enum */</span>
00041 } D3DXMESHDATATYPE;
00042 
00043 <span class="comment">//----------------------------------------------------------------------------</span>
00044 <span class="comment">// D3DXMESHDATA:</span>
00045 <span class="comment">// -------------</span>
00046 <span class="comment">// This struct encapsulates a the mesh data that can be present in a mesh </span>
00047 <span class="comment">// container.  The supported mesh types are pMesh, pPMesh, pPatchMesh.</span>
00048 <span class="comment">// The valid way to access this is determined by the Type enum.</span>
00049 <span class="comment">//----------------------------------------------------------------------------</span>
00050 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXMESHDATA
00051 {
00052     D3DXMESHDATATYPE Type;
00053 
00054     <span class="comment">// current mesh data interface</span>
00055     <span class="keyword">union</span>
00056 <span class="keyword">    </span>{
00057         LPD3DXMESH              pMesh;
00058         LPD3DXPMESH             pPMesh;
00059         LPD3DXPATCHMESH         pPatchMesh;
00060     };
00061 } D3DXMESHDATA, *LPD3DXMESHDATA;
00062 
00063 <span class="comment">//----------------------------------------------------------------------------</span>
00064 <span class="comment">// D3DXMESHCONTAINER:</span>
00065 <span class="comment">// ------------------</span>
00066 <span class="comment">// This struct encapsulates a mesh object in a transformation frame</span>
00067 <span class="comment">// hierarchy. The app can derive from this structure to add other app specific</span>
00068 <span class="comment">// data to this.</span>
00069 <span class="comment">//----------------------------------------------------------------------------</span>
00070 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXMESHCONTAINER
00071 {
00072     LPSTR                   Name;
00073 
00074     D3DXMESHDATA            MeshData;
00075 
00076     LPD3DXMATERIAL          pMaterials;
00077     LPD3DXEFFECTINSTANCE    pEffects;
00078     DWORD                   NumMaterials;
00079     DWORD                  *pAdjacency;
00080 
00081     LPD3DXSKININFO          pSkinInfo;
00082 
00083     <span class="keyword">struct </span>_D3DXMESHCONTAINER *pNextMeshContainer;
00084 } D3DXMESHCONTAINER, *LPD3DXMESHCONTAINER;
00085 
00086 <span class="comment">//----------------------------------------------------------------------------</span>
00087 <span class="comment">// D3DXFRAME:</span>
00088 <span class="comment">// ----------</span>
00089 <span class="comment">// This struct is the encapsulates a transform frame in a transformation frame</span>
00090 <span class="comment">// hierarchy. The app can derive from this structure to add other app specific</span>
00091 <span class="comment">// data to this</span>
00092 <span class="comment">//----------------------------------------------------------------------------</span>
00093 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXFRAME
00094 {
00095     LPSTR                   Name;
00096     D3DXMATRIX              TransformationMatrix;
00097 
00098     LPD3DXMESHCONTAINER     pMeshContainer;
00099 
00100     <span class="keyword">struct </span>_D3DXFRAME       *pFrameSibling;
00101     <span class="keyword">struct </span>_D3DXFRAME       *pFrameFirstChild;
00102 } D3DXFRAME, *LPD3DXFRAME;
00103 
00104 
00105 <span class="comment">//----------------------------------------------------------------------------</span>
00106 <span class="comment">// ID3DXAllocateHierarchy:</span>
00107 <span class="comment">// -----------------------</span>
00108 <span class="comment">// This interface is implemented by the application to allocate/free frame and</span>
00109 <span class="comment">// mesh container objects. Methods on this are called during loading and</span>
00110 <span class="comment">// destroying frame hierarchies</span>
00111 <span class="comment">//----------------------------------------------------------------------------</span>
00112 <span class="keyword">typedef</span> interface ID3DXAllocateHierarchy ID3DXAllocateHierarchy;
00113 <span class="keyword">typedef</span> interface ID3DXAllocateHierarchy *LPD3DXALLOCATEHIERARCHY;
00114 
00115 <span class="preprocessor">#undef INTERFACE</span>
00116 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXAllocateHierarchy</span>
00117 <span class="preprocessor"></span>
00118 DECLARE_INTERFACE(ID3DXAllocateHierarchy)
00119 {
00120     <span class="comment">// ID3DXAllocateHierarchy</span>
00121 
00122     <span class="comment">//------------------------------------------------------------------------</span>
00123     <span class="comment">// CreateFrame:</span>
00124     <span class="comment">// ------------</span>
00125     <span class="comment">// Requests allocation of a frame object.</span>
00126     <span class="comment">//</span>
00127     <span class="comment">// Parameters:</span>
00128     <span class="comment">//  Name</span>
00129     <span class="comment">//      Name of the frame to be created</span>
00130     <span class="comment">//  ppNewFrame</span>
00131     <span class="comment">//      Returns the created frame object</span>
00132     <span class="comment">//</span>
00133     <span class="comment">//------------------------------------------------------------------------</span>
00134     STDMETHOD(CreateFrame)(THIS_ LPCSTR Name, 
00135                             LPD3DXFRAME *ppNewFrame) PURE;
00136 
00137     <span class="comment">//------------------------------------------------------------------------</span>
00138     <span class="comment">// CreateMeshContainer:</span>
00139     <span class="comment">// --------------------</span>
00140     <span class="comment">// Requests allocation of a mesh container object.</span>
00141     <span class="comment">//</span>
00142     <span class="comment">// Parameters:</span>
00143     <span class="comment">//  Name</span>
00144     <span class="comment">//      Name of the mesh</span>
00145     <span class="comment">//  pMesh</span>
00146     <span class="comment">//      Pointer to the mesh object if basic polygon data found</span>
00147     <span class="comment">//  pPMesh</span>
00148     <span class="comment">//      Pointer to the progressive mesh object if progressive mesh data found</span>
00149     <span class="comment">//  pPatchMesh</span>
00150     <span class="comment">//      Pointer to the patch mesh object if patch data found</span>
00151     <span class="comment">//  pMaterials</span>
00152     <span class="comment">//      Array of materials used in the mesh</span>
00153     <span class="comment">//  pEffectInstances</span>
00154     <span class="comment">//      Array of effect instances used in the mesh</span>
00155     <span class="comment">//  NumMaterials</span>
00156     <span class="comment">//      Num elements in the pMaterials array</span>
00157     <span class="comment">//  pAdjacency</span>
00158     <span class="comment">//      Adjacency array for the mesh</span>
00159     <span class="comment">//  pSkinInfo</span>
00160     <span class="comment">//      Pointer to the skininfo object if the mesh is skinned</span>
00161     <span class="comment">//  pBoneNames</span>
00162     <span class="comment">//      Array of names, one for each bone in the skinned mesh. </span>
00163     <span class="comment">//      The numberof bones can be found from the pSkinMesh object</span>
00164     <span class="comment">//  pBoneOffsetMatrices</span>
00165     <span class="comment">//      Array of matrices, one for each bone in the skinned mesh.</span>
00166     <span class="comment">//</span>
00167     <span class="comment">//------------------------------------------------------------------------</span>
00168     STDMETHOD(CreateMeshContainer)(THIS_ 
00169         LPCSTR Name, 
00170         CONST D3DXMESHDATA *pMeshData, 
00171         CONST D3DXMATERIAL *pMaterials, 
00172         CONST D3DXEFFECTINSTANCE *pEffectInstances, 
00173         DWORD NumMaterials, 
00174         CONST DWORD *pAdjacency, 
00175         LPD3DXSKININFO pSkinInfo, 
00176         LPD3DXMESHCONTAINER *ppNewMeshContainer) PURE;
00177 
00178     <span class="comment">//------------------------------------------------------------------------</span>
00179     <span class="comment">// DestroyFrame:</span>
00180     <span class="comment">// -------------</span>
00181     <span class="comment">// Requests de-allocation of a frame object.</span>
00182     <span class="comment">//</span>
00183     <span class="comment">// Parameters:</span>
00184     <span class="comment">//  pFrameToFree</span>
00185     <span class="comment">//      Pointer to the frame to be de-allocated</span>
00186     <span class="comment">//</span>
00187     <span class="comment">//------------------------------------------------------------------------</span>
00188     STDMETHOD(DestroyFrame)(THIS_ LPD3DXFRAME pFrameToFree) PURE; 
00189 
00190     <span class="comment">//------------------------------------------------------------------------</span>
00191     <span class="comment">// DestroyMeshContainer:</span>
00192     <span class="comment">// ---------------------</span>
00193     <span class="comment">// Requests de-allocation of a mesh container object.</span>
00194     <span class="comment">//</span>
00195     <span class="comment">// Parameters:</span>
00196     <span class="comment">//  pMeshContainerToFree</span>
00197     <span class="comment">//      Pointer to the mesh container object to be de-allocated</span>
00198     <span class="comment">//</span>
00199     <span class="comment">//------------------------------------------------------------------------</span>
00200     STDMETHOD(DestroyMeshContainer)(THIS_ LPD3DXMESHCONTAINER pMeshContainerToFree) PURE; 
00201 };
00202 
00203 <span class="comment">//----------------------------------------------------------------------------</span>
00204 <span class="comment">// ID3DXLoadUserData:</span>
00205 <span class="comment">// ------------------</span>
00206 <span class="comment">// This interface is implemented by the application to load user data in a .X file</span>
00207 <span class="comment">// When user data is found, these callbacks will be used to allow the application</span>
00208 <span class="comment">// to load the data.</span>
00209 <span class="comment">//----------------------------------------------------------------------------</span>
00210 <span class="keyword">typedef</span> interface ID3DXLoadUserData ID3DXLoadUserData;
00211 <span class="keyword">typedef</span> interface ID3DXLoadUserData *LPD3DXLOADUSERDATA;
00212 
00213 <span class="preprocessor">#undef INTERFACE</span>
00214 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXLoadUserData</span>
00215 <span class="preprocessor"></span>
00216 DECLARE_INTERFACE(ID3DXLoadUserData)
00217 {
00218     STDMETHOD(LoadTopLevelData)(LPD3DXFILEDATA pXofChildData) PURE;
00219                             
00220     STDMETHOD(LoadFrameChildData)(LPD3DXFRAME pFrame, 
00221                             LPD3DXFILEDATA pXofChildData) PURE;
00222                             
00223     STDMETHOD(LoadMeshChildData)(LPD3DXMESHCONTAINER pMeshContainer, 
00224                             LPD3DXFILEDATA pXofChildData) PURE;                            
00225 };
00226 
00227 <span class="comment">//----------------------------------------------------------------------------</span>
00228 <span class="comment">// ID3DXSaveUserData:</span>
00229 <span class="comment">// ------------------</span>
00230 <span class="comment">// This interface is implemented by the application to save user data in a .X file</span>
00231 <span class="comment">// The callbacks are called for all data saved.  The user can then add any</span>
00232 <span class="comment">// child data objects to the object provided to the callback.</span>
00233 <span class="comment">//----------------------------------------------------------------------------</span>
00234 <span class="keyword">typedef</span> interface ID3DXSaveUserData ID3DXSaveUserData;
00235 <span class="keyword">typedef</span> interface ID3DXSaveUserData *LPD3DXSAVEUSERDATA;
00236 
00237 <span class="preprocessor">#undef INTERFACE</span>
00238 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXSaveUserData</span>
00239 <span class="preprocessor"></span>
00240 DECLARE_INTERFACE(ID3DXSaveUserData)
00241 {
00242     STDMETHOD(AddFrameChildData)(CONST D3DXFRAME *pFrame, 
00243                             LPD3DXFILESAVEOBJECT pXofSave, 
00244                             LPD3DXFILESAVEDATA pXofFrameData) PURE;
00245                             
00246     STDMETHOD(AddMeshChildData)(CONST D3DXMESHCONTAINER *pMeshContainer, 
00247                             LPD3DXFILESAVEOBJECT pXofSave, 
00248                             LPD3DXFILESAVEDATA pXofMeshData) PURE;
00249                             
00250     <span class="comment">// NOTE: this is called once per Save.  All top level objects should be added using the </span>
00251     <span class="comment">//    provided interface.  One call adds objects before the frame hierarchy, the other after</span>
00252     STDMETHOD(AddTopLevelDataObjectsPre)(LPD3DXFILESAVEOBJECT pXofSave) PURE; 
00253     STDMETHOD(AddTopLevelDataObjectsPost)(LPD3DXFILESAVEOBJECT pXofSave) PURE;                             
00254 
00255     <span class="comment">// callbacks for the user to register and then save templates to the XFile</span>
00256     STDMETHOD(RegisterTemplates)(LPD3DXFILE pXFileApi) PURE;                             
00257     STDMETHOD(SaveTemplates)(LPD3DXFILESAVEOBJECT pXofSave) PURE;                             
00258 };
00259 
00260 
00261 <span class="comment">//----------------------------------------------------------------------------</span>
00262 <span class="comment">// D3DXCALLBACK_SEARCH_FLAGS:</span>
00263 <span class="comment">// --------------------------</span>
00264 <span class="comment">// Flags that can be passed into ID3DXAnimationSet::GetCallback. </span>
00265 <span class="comment">//----------------------------------------------------------------------------</span>
00266 <span class="keyword">typedef</span> <span class="keyword">enum</span> _D3DXCALLBACK_SEARCH_FLAGS
00267 {
00268     D3DXCALLBACK_SEARCH_EXCLUDING_INITIAL_POSITION = 0x01,  <span class="comment">// exclude callbacks at the initial position from the search</span>
00269     D3DXCALLBACK_SEARCH_BEHIND_INITIAL_POSITION    = 0x02,  <span class="comment">// reverse the callback search direction</span>
00270 
00271     D3DXCALLBACK_SEARCH_FORCE_DWORD                = 0x7fffffff,
00272 } D3DXCALLBACK_SEARCH_FLAGS;
00273 
00274 <span class="comment">//----------------------------------------------------------------------------</span>
00275 <span class="comment">// ID3DXAnimationSet:</span>
00276 <span class="comment">// ------------------</span>
00277 <span class="comment">// This interface implements an animation set.</span>
00278 <span class="comment">//----------------------------------------------------------------------------</span>
00279 <span class="keyword">typedef</span> interface ID3DXAnimationSet ID3DXAnimationSet;
00280 <span class="keyword">typedef</span> interface ID3DXAnimationSet *LPD3DXANIMATIONSET;
00281 
00282 <span class="preprocessor">#undef INTERFACE</span>
00283 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXAnimationSet</span>
00284 <span class="preprocessor"></span>
00285 DECLARE_INTERFACE_(ID3DXAnimationSet, IUnknown)
00286 {
00287     <span class="comment">// IUnknown</span>
00288     STDMETHOD(QueryInterface)(THIS_ REFIID iid, LPVOID *ppv) PURE;
00289     STDMETHOD_(ULONG, AddRef)(THIS) PURE;
00290     STDMETHOD_(ULONG, Release)(THIS) PURE;
00291 
00292     <span class="comment">// Name</span>
00293     STDMETHOD_(LPCSTR, GetName)(THIS) PURE;
00294 
00295     <span class="comment">// Period</span>
00296     STDMETHOD_(DOUBLE, GetPeriod)(THIS) PURE;
00297     STDMETHOD_(DOUBLE, GetPeriodicPosition)(THIS_ DOUBLE Position) PURE;    <span class="comment">// Maps position into animation period</span>
00298 
00299     <span class="comment">// Animation names</span>
00300     STDMETHOD_(UINT, GetNumAnimations)(THIS) PURE;
00301     STDMETHOD(GetAnimationNameByIndex)(THIS_ UINT Index, LPCSTR *ppName) PURE;
00302     STDMETHOD(GetAnimationIndexByName)(THIS_ LPCSTR pName, UINT *pIndex) PURE;
00303 
00304     <span class="comment">// SRT</span>
00305     STDMETHOD(GetSRT)(THIS_ 
00306         DOUBLE PeriodicPosition,            <span class="comment">// Position mapped to period (use GetPeriodicPosition)</span>
00307         UINT Animation,                     <span class="comment">// Animation index</span>
00308         D3DXVECTOR3 *pScale,                <span class="comment">// Returns the scale</span>
00309         D3DXQUATERNION *pRotation,          <span class="comment">// Returns the rotation as a quaternion</span>
00310         D3DXVECTOR3 *pTranslation) PURE;    <span class="comment">// Returns the translation</span>
00311 
00312     <span class="comment">// Callbacks</span>
00313     STDMETHOD(GetCallback)(THIS_ 
00314         DOUBLE Position,                    <span class="comment">// Position from which to find callbacks</span>
00315         DWORD Flags,                        <span class="comment">// Callback search flags</span>
00316         DOUBLE *pCallbackPosition,          <span class="comment">// Returns the position of the callback</span>
00317         LPVOID *ppCallbackData) PURE;       <span class="comment">// Returns the callback data pointer</span>
00318 };
00319 
00320 
00321 <span class="comment">//----------------------------------------------------------------------------</span>
00322 <span class="comment">// D3DXPLAYBACK_TYPE:</span>
00323 <span class="comment">// ------------------</span>
00324 <span class="comment">// This enum defines the type of animation set loop modes.</span>
00325 <span class="comment">//----------------------------------------------------------------------------</span>
00326 <span class="keyword">typedef</span> <span class="keyword">enum</span> _D3DXPLAYBACK_TYPE
00327 {
00328     D3DXPLAY_LOOP          = 0,
00329     D3DXPLAY_ONCE          = 1,
00330     D3DXPLAY_PINGPONG      = 2,
00331 
00332     D3DXPLAY_FORCE_DWORD   = 0x7fffffff, <span class="comment">/* force 32-bit size enum */</span>
00333 } D3DXPLAYBACK_TYPE;
00334 
00335 
00336 <span class="comment">//----------------------------------------------------------------------------</span>
00337 <span class="comment">// D3DXKEY_VECTOR3:</span>
00338 <span class="comment">// ----------------</span>
00339 <span class="comment">// This structure describes a vector key for use in keyframe animation.</span>
00340 <span class="comment">// It specifies a vector Value at a given Time. This is used for scale and</span>
00341 <span class="comment">// translation keys.</span>
00342 <span class="comment">//----------------------------------------------------------------------------</span>
00343 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXKEY_VECTOR3
00344 {
00345     FLOAT Time;
00346     D3DXVECTOR3 Value;
00347 } D3DXKEY_VECTOR3, *LPD3DXKEY_VECTOR3;
00348 
00349 
00350 <span class="comment">//----------------------------------------------------------------------------</span>
00351 <span class="comment">// D3DXKEY_QUATERNION:</span>
00352 <span class="comment">// -------------------</span>
00353 <span class="comment">// This structure describes a quaternion key for use in keyframe animation.</span>
00354 <span class="comment">// It specifies a quaternion Value at a given Time. This is used for rotation</span>
00355 <span class="comment">// keys.</span>
00356 <span class="comment">//----------------------------------------------------------------------------</span>
00357 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXKEY_QUATERNION
00358 {
00359     FLOAT Time;
00360     D3DXQUATERNION Value;
00361 } D3DXKEY_QUATERNION, *LPD3DXKEY_QUATERNION;
00362 
00363 
00364 <span class="comment">//----------------------------------------------------------------------------</span>
00365 <span class="comment">// D3DXKEY_CALLBACK:</span>
00366 <span class="comment">// -----------------</span>
00367 <span class="comment">// This structure describes an callback key for use in keyframe animation.</span>
00368 <span class="comment">// It specifies a pointer to user data at a given Time. </span>
00369 <span class="comment">//----------------------------------------------------------------------------</span>
00370 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXKEY_CALLBACK
00371 {
00372     FLOAT Time;
00373     LPVOID pCallbackData;
00374 } D3DXKEY_CALLBACK, *LPD3DXKEY_CALLBACK;
00375 
00376 
00377 <span class="comment">//----------------------------------------------------------------------------</span>
00378 <span class="comment">// D3DXCOMPRESSION_FLAGS:</span>
00379 <span class="comment">// ----------------------</span>
00380 <span class="comment">// Flags that can be passed into ID3DXKeyframedAnimationSet::Compress. </span>
00381 <span class="comment">//----------------------------------------------------------------------------</span>
00382 <span class="keyword">typedef</span> <span class="keyword">enum</span> _D3DXCOMPRESSION_FLAGS
00383 {
00384     D3DXCOMPRESS_DEFAULT     = 0x00,
00385 
00386     D3DXCOMPRESS_FORCE_DWORD = 0x7fffffff,
00387 } D3DXCOMPRESSION_FLAGS;
00388 
00389 
00390 <span class="comment">//----------------------------------------------------------------------------</span>
00391 <span class="comment">// ID3DXKeyframedAnimationSet:</span>
00392 <span class="comment">// ---------------------------</span>
00393 <span class="comment">// This interface implements a compressable keyframed animation set.</span>
00394 <span class="comment">//----------------------------------------------------------------------------</span>
00395 <span class="keyword">typedef</span> interface ID3DXKeyframedAnimationSet ID3DXKeyframedAnimationSet;
00396 <span class="keyword">typedef</span> interface ID3DXKeyframedAnimationSet *LPD3DXKEYFRAMEDANIMATIONSET;
00397 
00398 <span class="preprocessor">#undef INTERFACE</span>
00399 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXKeyframedAnimationSet</span>
00400 <span class="preprocessor"></span>
00401 DECLARE_INTERFACE_(ID3DXKeyframedAnimationSet, ID3DXAnimationSet)
00402 {
00403     <span class="comment">// ID3DXAnimationSet</span>
00404     STDMETHOD(QueryInterface)(THIS_ REFIID iid, LPVOID *ppv) PURE;
00405     STDMETHOD_(ULONG, AddRef)(THIS) PURE;
00406     STDMETHOD_(ULONG, Release)(THIS) PURE;
00407 
00408     <span class="comment">// Name</span>
00409     STDMETHOD_(LPCSTR, GetName)(THIS) PURE;
00410 
00411     <span class="comment">// Period</span>
00412     STDMETHOD_(DOUBLE, GetPeriod)(THIS) PURE;
00413     STDMETHOD_(DOUBLE, GetPeriodicPosition)(THIS_ DOUBLE Position) PURE;    <span class="comment">// Maps position into animation period</span>
00414 
00415     <span class="comment">// Animation names</span>
00416     STDMETHOD_(UINT, GetNumAnimations)(THIS) PURE;
00417     STDMETHOD(GetAnimationNameByIndex)(THIS_ UINT Index, LPCSTR *ppName) PURE;
00418     STDMETHOD(GetAnimationIndexByName)(THIS_ LPCSTR pName, UINT *pIndex) PURE;
00419 
00420     <span class="comment">// SRT</span>
00421     STDMETHOD(GetSRT)(THIS_ 
00422         DOUBLE PeriodicPosition,            <span class="comment">// Position mapped to period (use GetPeriodicPosition)</span>
00423         UINT Animation,                     <span class="comment">// Animation index</span>
00424         D3DXVECTOR3 *pScale,                <span class="comment">// Returns the scale</span>
00425         D3DXQUATERNION *pRotation,          <span class="comment">// Returns the rotation as a quaternion</span>
00426         D3DXVECTOR3 *pTranslation) PURE;    <span class="comment">// Returns the translation</span>
00427 
00428     <span class="comment">// Callbacks</span>
00429     STDMETHOD(GetCallback)(THIS_ 
00430         DOUBLE Position,                    <span class="comment">// Position from which to find callbacks</span>
00431         DWORD Flags,                        <span class="comment">// Callback search flags</span>
00432         DOUBLE *pCallbackPosition,          <span class="comment">// Returns the position of the callback</span>
00433         LPVOID *ppCallbackData) PURE;       <span class="comment">// Returns the callback data pointer</span>
00434 
00435     <span class="comment">// Playback</span>
00436     STDMETHOD_(D3DXPLAYBACK_TYPE, GetPlaybackType)(THIS) PURE;
00437     STDMETHOD_(DOUBLE, GetSourceTicksPerSecond)(THIS) PURE;
00438 
00439     <span class="comment">// Scale keys</span>
00440     STDMETHOD_(UINT, GetNumScaleKeys)(THIS_ UINT Animation) PURE;
00441     STDMETHOD(GetScaleKeys)(THIS_ UINT Animation, LPD3DXKEY_VECTOR3 pScaleKeys) PURE;
00442     STDMETHOD(GetScaleKey)(THIS_ UINT Animation, UINT Key, LPD3DXKEY_VECTOR3 pScaleKey) PURE;
00443     STDMETHOD(SetScaleKey)(THIS_ UINT Animation, UINT Key, LPD3DXKEY_VECTOR3 pScaleKey) PURE;
00444 
00445     <span class="comment">// Rotation keys</span>
00446     STDMETHOD_(UINT, GetNumRotationKeys)(THIS_ UINT Animation) PURE;
00447     STDMETHOD(GetRotationKeys)(THIS_ UINT Animation, LPD3DXKEY_QUATERNION pRotationKeys) PURE;
00448     STDMETHOD(GetRotationKey)(THIS_ UINT Animation, UINT Key, LPD3DXKEY_QUATERNION pRotationKey) PURE;
00449     STDMETHOD(SetRotationKey)(THIS_ UINT Animation, UINT Key, LPD3DXKEY_QUATERNION pRotationKey) PURE;
00450 
00451     <span class="comment">// Translation keys</span>
00452     STDMETHOD_(UINT, GetNumTranslationKeys)(THIS_ UINT Animation) PURE;
00453     STDMETHOD(GetTranslationKeys)(THIS_ UINT Animation, LPD3DXKEY_VECTOR3 pTranslationKeys) PURE;
00454     STDMETHOD(GetTranslationKey)(THIS_ UINT Animation, UINT Key, LPD3DXKEY_VECTOR3 pTranslationKey) PURE;
00455     STDMETHOD(SetTranslationKey)(THIS_ UINT Animation, UINT Key, LPD3DXKEY_VECTOR3 pTranslationKey) PURE;
00456 
00457     <span class="comment">// Callback keys</span>
00458     STDMETHOD_(UINT, GetNumCallbackKeys)(THIS) PURE;
00459     STDMETHOD(GetCallbackKeys)(THIS_ LPD3DXKEY_CALLBACK pCallbackKeys) PURE;
00460     STDMETHOD(GetCallbackKey)(THIS_ UINT Key, LPD3DXKEY_CALLBACK pCallbackKey) PURE;
00461     STDMETHOD(SetCallbackKey)(THIS_ UINT Key, LPD3DXKEY_CALLBACK pCallbackKey) PURE;
00462 
00463     <span class="comment">// Key removal methods. These are slow, and should not be used once the animation starts playing</span>
00464     STDMETHOD(UnregisterScaleKey)(THIS_ UINT Animation, UINT Key) PURE;
00465     STDMETHOD(UnregisterRotationKey)(THIS_ UINT Animation, UINT Key) PURE;
00466     STDMETHOD(UnregisterTranslationKey)(THIS_ UINT Animation, UINT Key) PURE;
00467 
00468     <span class="comment">// One-time animaton SRT keyframe registration</span>
00469     STDMETHOD(RegisterAnimationSRTKeys)(THIS_ 
00470         LPCSTR pName,                                   <span class="comment">// Animation name</span>
00471         UINT NumScaleKeys,                              <span class="comment">// Number of scale keys</span>
00472         UINT NumRotationKeys,                           <span class="comment">// Number of rotation keys</span>
00473         UINT NumTranslationKeys,                        <span class="comment">// Number of translation keys</span>
00474         CONST D3DXKEY_VECTOR3 *pScaleKeys,              <span class="comment">// Array of scale keys</span>
00475         CONST D3DXKEY_QUATERNION *pRotationKeys,        <span class="comment">// Array of rotation keys</span>
00476         CONST D3DXKEY_VECTOR3 *pTranslationKeys,        <span class="comment">// Array of translation keys</span>
00477         DWORD *pAnimationIndex) PURE;                   <span class="comment">// Returns the animation index </span>
00478 
00479     <span class="comment">// Compression</span>
00480     STDMETHOD(Compress)(THIS_ 
00481         DWORD Flags,                            <span class="comment">// Compression flags (use D3DXCOMPRESS_STRONG for better results)</span>
00482         FLOAT Lossiness,                        <span class="comment">// Compression loss ratio in the [0, 1] range</span>
00483         LPD3DXFRAME pHierarchy,                 <span class="comment">// Frame hierarchy (optional)</span>
00484         LPD3DXBUFFER *ppCompressedData) PURE;   <span class="comment">// Returns the compressed animation set</span>
00485 
00486     STDMETHOD(UnregisterAnimation)(THIS_ UINT Index) PURE;
00487 };
00488 
00489 
00490 <span class="comment">//----------------------------------------------------------------------------</span>
00491 <span class="comment">// ID3DXCompressedAnimationSet:</span>
00492 <span class="comment">// ----------------------------</span>
00493 <span class="comment">// This interface implements a compressed keyframed animation set.</span>
00494 <span class="comment">//----------------------------------------------------------------------------</span>
00495 <span class="keyword">typedef</span> interface ID3DXCompressedAnimationSet ID3DXCompressedAnimationSet;
00496 <span class="keyword">typedef</span> interface ID3DXCompressedAnimationSet *LPD3DXCOMPRESSEDANIMATIONSET;
00497 
00498 <span class="preprocessor">#undef INTERFACE</span>
00499 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXCompressedAnimationSet</span>
00500 <span class="preprocessor"></span>
00501 DECLARE_INTERFACE_(ID3DXCompressedAnimationSet, ID3DXAnimationSet)
00502 {
00503     <span class="comment">// ID3DXAnimationSet</span>
00504     STDMETHOD(QueryInterface)(THIS_ REFIID iid, LPVOID *ppv) PURE;
00505     STDMETHOD_(ULONG, AddRef)(THIS) PURE;
00506     STDMETHOD_(ULONG, Release)(THIS) PURE;
00507 
00508     <span class="comment">// Name</span>
00509     STDMETHOD_(LPCSTR, GetName)(THIS) PURE;
00510 
00511     <span class="comment">// Period</span>
00512     STDMETHOD_(DOUBLE, GetPeriod)(THIS) PURE;
00513     STDMETHOD_(DOUBLE, GetPeriodicPosition)(THIS_ DOUBLE Position) PURE;    <span class="comment">// Maps position into animation period</span>
00514 
00515     <span class="comment">// Animation names</span>
00516     STDMETHOD_(UINT, GetNumAnimations)(THIS) PURE;
00517     STDMETHOD(GetAnimationNameByIndex)(THIS_ UINT Index, LPCSTR *ppName) PURE;
00518     STDMETHOD(GetAnimationIndexByName)(THIS_ LPCSTR pName, UINT *pIndex) PURE;
00519 
00520     <span class="comment">// SRT</span>
00521     STDMETHOD(GetSRT)(THIS_ 
00522         DOUBLE PeriodicPosition,            <span class="comment">// Position mapped to period (use GetPeriodicPosition)</span>
00523         UINT Animation,                     <span class="comment">// Animation index</span>
00524         D3DXVECTOR3 *pScale,                <span class="comment">// Returns the scale</span>
00525         D3DXQUATERNION *pRotation,          <span class="comment">// Returns the rotation as a quaternion</span>
00526         D3DXVECTOR3 *pTranslation) PURE;    <span class="comment">// Returns the translation</span>
00527 
00528     <span class="comment">// Callbacks</span>
00529     STDMETHOD(GetCallback)(THIS_ 
00530         DOUBLE Position,                    <span class="comment">// Position from which to find callbacks</span>
00531         DWORD Flags,                        <span class="comment">// Callback search flags</span>
00532         DOUBLE *pCallbackPosition,          <span class="comment">// Returns the position of the callback</span>
00533         LPVOID *ppCallbackData) PURE;       <span class="comment">// Returns the callback data pointer</span>
00534 
00535     <span class="comment">// Playback</span>
00536     STDMETHOD_(D3DXPLAYBACK_TYPE, GetPlaybackType)(THIS) PURE;
00537     STDMETHOD_(DOUBLE, GetSourceTicksPerSecond)(THIS) PURE;
00538 
00539     <span class="comment">// Scale keys</span>
00540     STDMETHOD(GetCompressedData)(THIS_ LPD3DXBUFFER *ppCompressedData) PURE;
00541 
00542     <span class="comment">// Callback keys</span>
00543     STDMETHOD_(UINT, GetNumCallbackKeys)(THIS) PURE;
00544     STDMETHOD(GetCallbackKeys)(THIS_ LPD3DXKEY_CALLBACK pCallbackKeys) PURE;
00545 };
00546 
00547 
00548 <span class="comment">//----------------------------------------------------------------------------</span>
00549 <span class="comment">// D3DXPRIORITY_TYPE:</span>
00550 <span class="comment">// ------------------</span>
00551 <span class="comment">// This enum defines the type of priority group that a track can be assigned to.</span>
00552 <span class="comment">//----------------------------------------------------------------------------</span>
00553 <span class="keyword">typedef</span> <span class="keyword">enum</span> _D3DXPRIORITY_TYPE {
00554     D3DXPRIORITY_LOW         = 0,           <span class="comment">// This track should be blended with all low priority tracks before mixed with the high priority result</span>
00555     D3DXPRIORITY_HIGH        = 1,           <span class="comment">// This track should be blended with all high priority tracks before mixed with the low priority result</span>
00556 
00557     D3DXPRIORITY_FORCE_DWORD = 0x7fffffff,  <span class="comment">/* force 32-bit size enum */</span>
00558 } D3DXPRIORITY_TYPE;
00559 
00560 <span class="comment">//----------------------------------------------------------------------------</span>
00561 <span class="comment">// D3DXTRACK_DESC:</span>
00562 <span class="comment">// ---------------</span>
00563 <span class="comment">// This structure describes the mixing information of an animation track. </span>
00564 <span class="comment">// The mixing information consists of the current position, speed, and blending </span>
00565 <span class="comment">// weight for the track.  The Flags field also specifies whether the track is </span>
00566 <span class="comment">// low or high priority.  Tracks with the same priority are blended together</span>
00567 <span class="comment">// and then the two resulting values are blended using the priority blend factor.</span>
00568 <span class="comment">// A track also has an animation set (stored separately) associated with it.  </span>
00569 <span class="comment">//----------------------------------------------------------------------------</span>
00570 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXTRACK_DESC
00571 {
00572     D3DXPRIORITY_TYPE   Priority;
00573     FLOAT               Weight;
00574     FLOAT               Speed;
00575     DOUBLE              Position;
00576     BOOL                Enable;
00577 } D3DXTRACK_DESC, *LPD3DXTRACK_DESC;
00578 
00579 <span class="comment">//----------------------------------------------------------------------------</span>
00580 <span class="comment">// D3DXEVENT_TYPE:</span>
00581 <span class="comment">// ---------------</span>
00582 <span class="comment">// This enum defines the type of events keyable via the animation controller.</span>
00583 <span class="comment">//----------------------------------------------------------------------------</span>
00584 <span class="keyword">typedef</span> <span class="keyword">enum</span> _D3DXEVENT_TYPE
00585 {
00586     D3DXEVENT_TRACKSPEED    = 0,
00587     D3DXEVENT_TRACKWEIGHT   = 1,
00588     D3DXEVENT_TRACKPOSITION = 2,
00589     D3DXEVENT_TRACKENABLE   = 3,
00590     D3DXEVENT_PRIORITYBLEND = 4,
00591 
00592     D3DXEVENT_FORCE_DWORD   = 0x7fffffff, <span class="comment">/* force 32-bit size enum */</span>
00593 } D3DXEVENT_TYPE;
00594 
00595 <span class="comment">//----------------------------------------------------------------------------</span>
00596 <span class="comment">// D3DXTRANSITION_TYPE:</span>
00597 <span class="comment">// --------------------</span>
00598 <span class="comment">// This enum defines the type of transtion performed on a event that </span>
00599 <span class="comment">// transitions from one value to another.</span>
00600 <span class="comment">//----------------------------------------------------------------------------</span>
00601 <span class="keyword">typedef</span> <span class="keyword">enum</span> _D3DXTRANSITION_TYPE {
00602     D3DXTRANSITION_LINEAR        = 0x000,     <span class="comment">// Linear transition from one value to the next</span>
00603     D3DXTRANSITION_EASEINEASEOUT = 0x001,     <span class="comment">// Ease-In Ease-Out spline transtion from one value to the next</span>
00604 
00605     D3DXTRANSITION_FORCE_DWORD   = 0x7fffffff, <span class="comment">/* force 32-bit size enum */</span>
00606 } D3DXTRANSITION_TYPE;
00607 
00608 <span class="comment">//----------------------------------------------------------------------------</span>
00609 <span class="comment">// D3DXEVENT_DESC:</span>
00610 <span class="comment">// ---------------</span>
00611 <span class="comment">// This structure describes a animation controller event.</span>
00612 <span class="comment">// It gives the event's type, track (if the event is a track event), global </span>
00613 <span class="comment">// start time, duration, transition method, and target value.</span>
00614 <span class="comment">//----------------------------------------------------------------------------</span>
00615 <span class="keyword">typedef</span> <span class="keyword">struct </span>_D3DXEVENT_DESC
00616 {
00617     D3DXEVENT_TYPE      Type;
00618     UINT                Track;
00619     DOUBLE              StartTime;
00620     DOUBLE              Duration;
00621     D3DXTRANSITION_TYPE Transition;
00622     <span class="keyword">union</span>
00623 <span class="keyword">    </span>{
00624         FLOAT           Weight;
00625         FLOAT           Speed;
00626         DOUBLE          Position;
00627         BOOL            Enable;
00628     };
00629 } D3DXEVENT_DESC, *LPD3DXEVENT_DESC;
00630 
00631 <span class="comment">//----------------------------------------------------------------------------</span>
00632 <span class="comment">// D3DXEVENTHANDLE:</span>
00633 <span class="comment">// ----------------</span>
00634 <span class="comment">// Handle values used to efficiently reference animation controller events.</span>
00635 <span class="comment">//----------------------------------------------------------------------------</span>
00636 <span class="keyword">typedef</span> DWORD D3DXEVENTHANDLE;
00637 <span class="keyword">typedef</span> D3DXEVENTHANDLE *LPD3DXEVENTHANDLE;
00638 
00639 
00640 <span class="comment">//----------------------------------------------------------------------------</span>
00641 <span class="comment">// ID3DXAnimationCallbackHandler:</span>
00642 <span class="comment">// ------------------------------</span>
00643 <span class="comment">// This interface is intended to be implemented by the application, and can</span>
00644 <span class="comment">// be used to handle callbacks in animation sets generated when </span>
00645 <span class="comment">// ID3DXAnimationController::AdvanceTime() is called.  </span>
00646 <span class="comment">//----------------------------------------------------------------------------</span>
00647 <span class="keyword">typedef</span> interface ID3DXAnimationCallbackHandler ID3DXAnimationCallbackHandler;
00648 <span class="keyword">typedef</span> interface ID3DXAnimationCallbackHandler *LPD3DXANIMATIONCALLBACKHANDLER;
00649 
00650 <span class="preprocessor">#undef INTERFACE</span>
00651 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXAnimationCallbackHandler</span>
00652 <span class="preprocessor"></span>
00653 DECLARE_INTERFACE(ID3DXAnimationCallbackHandler)
00654 {
00655     <span class="comment">//----------------------------------------------------------------------------</span>
00656     <span class="comment">// ID3DXAnimationCallbackHandler::HandleCallback:</span>
00657     <span class="comment">// ----------------------------------------------</span>
00658     <span class="comment">// This method gets called when a callback occurs for an animation set in one</span>
00659     <span class="comment">// of the tracks during the ID3DXAnimationController::AdvanceTime() call.  </span>
00660     <span class="comment">//</span>
00661     <span class="comment">// Parameters:</span>
00662     <span class="comment">//  Track</span>
00663     <span class="comment">//      Index of the track on which the callback occured.</span>
00664     <span class="comment">//  pCallbackData</span>
00665     <span class="comment">//      Pointer to user owned callback data.</span>
00666     <span class="comment">//</span>
00667     <span class="comment">//----------------------------------------------------------------------------</span>
00668     STDMETHOD(HandleCallback)(THIS_ UINT Track, LPVOID pCallbackData) PURE; 
00669 };
00670 
00671 
00672 <span class="comment">//----------------------------------------------------------------------------</span>
00673 <span class="comment">// ID3DXAnimationController:</span>
00674 <span class="comment">// -------------------------</span>
00675 <span class="comment">// This interface implements the main animation functionality. It connects</span>
00676 <span class="comment">// animation sets with the transform frames that are being animated. Allows</span>
00677 <span class="comment">// mixing multiple animations for blended animations or for transistions</span>
00678 <span class="comment">// It adds also has methods to modify blending parameters over time to </span>
00679 <span class="comment">// enable smooth transistions and other effects.</span>
00680 <span class="comment">//----------------------------------------------------------------------------</span>
00681 <span class="keyword">typedef</span> interface ID3DXAnimationController ID3DXAnimationController;
00682 <span class="keyword">typedef</span> interface ID3DXAnimationController *LPD3DXANIMATIONCONTROLLER;
00683 
00684 <span class="preprocessor">#undef INTERFACE</span>
00685 <span class="preprocessor"></span><span class="preprocessor">#define INTERFACE ID3DXAnimationController</span>
00686 <span class="preprocessor"></span>
00687 DECLARE_INTERFACE_(ID3DXAnimationController, IUnknown)
00688 {
00689     <span class="comment">// IUnknown</span>
00690     STDMETHOD(QueryInterface)(THIS_ REFIID iid, LPVOID *ppv) PURE;
00691     STDMETHOD_(ULONG, AddRef)(THIS) PURE;
00692     STDMETHOD_(ULONG, Release)(THIS) PURE;
00693 
00694     <span class="comment">// Max sizes</span>
00695     STDMETHOD_(UINT, GetMaxNumAnimationOutputs)(THIS) PURE;
00696     STDMETHOD_(UINT, GetMaxNumAnimationSets)(THIS) PURE;
00697     STDMETHOD_(UINT, GetMaxNumTracks)(THIS) PURE;
00698     STDMETHOD_(UINT, GetMaxNumEvents)(THIS) PURE;
00699 
00700     <span class="comment">// Animation output registration</span>
00701     STDMETHOD(RegisterAnimationOutput)(THIS_ 
00702         LPCSTR pName, 
00703         D3DXMATRIX *pMatrix, 
00704         D3DXVECTOR3 *pScale, 
00705         D3DXQUATERNION *pRotation, 
00706         D3DXVECTOR3 *pTranslation) PURE;
00707 
00708     <span class="comment">// Animation set registration</span>
00709     STDMETHOD(RegisterAnimationSet)(THIS_ LPD3DXANIMATIONSET pAnimSet) PURE;
00710     STDMETHOD(UnregisterAnimationSet)(THIS_ LPD3DXANIMATIONSET pAnimSet) PURE;
00711 
00712     STDMETHOD_(UINT, GetNumAnimationSets)(THIS) PURE;
00713     STDMETHOD(GetAnimationSet)(THIS_ UINT Index, LPD3DXANIMATIONSET *ppAnimationSet) PURE;
00714     STDMETHOD(GetAnimationSetByName)(THIS_ LPCSTR szName, LPD3DXANIMATIONSET *ppAnimationSet) PURE;
00715 
00716     <span class="comment">// Global time</span>
00717     STDMETHOD(AdvanceTime)(THIS_ DOUBLE TimeDelta, LPD3DXANIMATIONCALLBACKHANDLER pCallbackHandler) PURE;
00718     STDMETHOD(ResetTime)(THIS) PURE;
00719     STDMETHOD_(DOUBLE, GetTime)(THIS) PURE;
00720 
00721     <span class="comment">// Tracks</span>
00722     STDMETHOD(SetTrackAnimationSet)(THIS_ UINT Track, LPD3DXANIMATIONSET pAnimSet) PURE;
00723     STDMETHOD(GetTrackAnimationSet)(THIS_ UINT Track, LPD3DXANIMATIONSET *ppAnimSet) PURE;
00724 
00725     STDMETHOD(SetTrackPriority)(THIS_ UINT Track, D3DXPRIORITY_TYPE Priority) PURE;
00726 
00727     STDMETHOD(SetTrackSpeed)(THIS_ UINT Track, FLOAT Speed) PURE;
00728     STDMETHOD(SetTrackWeight)(THIS_ UINT Track, FLOAT Weight) PURE;
00729     STDMETHOD(SetTrackPosition)(THIS_ UINT Track, DOUBLE Position) PURE;
00730     STDMETHOD(SetTrackEnable)(THIS_ UINT Track, BOOL Enable) PURE;
00731 
00732     STDMETHOD(SetTrackDesc)(THIS_ UINT Track, LPD3DXTRACK_DESC pDesc) PURE;
00733     STDMETHOD(GetTrackDesc)(THIS_ UINT Track, LPD3DXTRACK_DESC pDesc) PURE;
00734 
00735     <span class="comment">// Priority blending</span>
00736     STDMETHOD(SetPriorityBlend)(THIS_ FLOAT BlendWeight) PURE;
00737     STDMETHOD_(FLOAT, GetPriorityBlend)(THIS) PURE;
00738 
00739     <span class="comment">// Event keying</span>
00740     STDMETHOD_(D3DXEVENTHANDLE, KeyTrackSpeed)(THIS_ UINT Track, FLOAT NewSpeed, DOUBLE StartTime, DOUBLE Duration, D3DXTRANSITION_TYPE Transition) PURE;
00741     STDMETHOD_(D3DXEVENTHANDLE, KeyTrackWeight)(THIS_ UINT Track, FLOAT NewWeight, DOUBLE StartTime, DOUBLE Duration, D3DXTRANSITION_TYPE Transition) PURE;
00742     STDMETHOD_(D3DXEVENTHANDLE, KeyTrackPosition)(THIS_ UINT Track, DOUBLE NewPosition, DOUBLE StartTime) PURE;
00743     STDMETHOD_(D3DXEVENTHANDLE, KeyTrackEnable)(THIS_ UINT Track, BOOL NewEnable, DOUBLE StartTime) PURE;
00744 
00745     STDMETHOD_(D3DXEVENTHANDLE, KeyPriorityBlend)(THIS_ FLOAT NewBlendWeight, DOUBLE StartTime, DOUBLE Duration, D3DXTRANSITION_TYPE Transition) PURE;
00746 
00747     <span class="comment">// Event unkeying</span>
00748     STDMETHOD(UnkeyEvent)(THIS_ D3DXEVENTHANDLE hEvent) PURE;
00749 
00750     STDMETHOD(UnkeyAllTrackEvents)(THIS_ UINT Track) PURE;
00751     STDMETHOD(UnkeyAllPriorityBlends)(THIS) PURE;
00752 
00753     <span class="comment">// Event enumeration</span>
00754     STDMETHOD_(D3DXEVENTHANDLE, GetCurrentTrackEvent)(THIS_ UINT Track, D3DXEVENT_TYPE EventType) PURE;
00755     STDMETHOD_(D3DXEVENTHANDLE, GetCurrentPriorityBlend)(THIS) PURE;
00756 
00757     STDMETHOD_(D3DXEVENTHANDLE, GetUpcomingTrackEvent)(THIS_ UINT Track, D3DXEVENTHANDLE hEvent) PURE;
00758     STDMETHOD_(D3DXEVENTHANDLE, GetUpcomingPriorityBlend)(THIS_ D3DXEVENTHANDLE hEvent) PURE;
00759 
00760     STDMETHOD(ValidateEvent)(THIS_ D3DXEVENTHANDLE hEvent) PURE;
00761 
00762     STDMETHOD(GetEventDesc)(THIS_ D3DXEVENTHANDLE hEvent, LPD3DXEVENT_DESC pDesc) PURE;
00763 
00764     <span class="comment">// Cloning</span>
00765     STDMETHOD(CloneAnimationController)(THIS_ 
00766         UINT MaxNumAnimationOutputs, 
00767         UINT MaxNumAnimationSets, 
00768         UINT MaxNumTracks, 
00769         UINT MaxNumEvents, 
00770         LPD3DXANIMATIONCONTROLLER *ppAnimController) PURE;
00771 };
00772 
00773 <span class="preprocessor">#ifdef __cplusplus</span>
00774 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00775 <span class="preprocessor">#endif //__cplusplus</span>
00776 <span class="preprocessor"></span>
00777 
00778 <span class="comment">//----------------------------------------------------------------------------</span>
00779 <span class="comment">// D3DXLoadMeshHierarchyFromX:</span>
00780 <span class="comment">// ---------------------------</span>
00781 <span class="comment">// Loads the first frame hierarchy in a .X file.</span>
00782 <span class="comment">//</span>
00783 <span class="comment">// Parameters:</span>
00784 <span class="comment">//  Filename</span>
00785 <span class="comment">//      Name of the .X file</span>
00786 <span class="comment">//  MeshOptions</span>
00787 <span class="comment">//      Mesh creation options for meshes in the file (see d3dx9mesh.h)</span>
00788 <span class="comment">//  pD3DDevice</span>
00789 <span class="comment">//      D3D9 device on which meshes in the file are created in</span>
00790 <span class="comment">//  pAlloc</span>
00791 <span class="comment">//      Allocation interface used to allocate nodes of the frame hierarchy</span>
00792 <span class="comment">//  pUserDataLoader</span>
00793 <span class="comment">//      Application provided interface to allow loading of user data</span>
00794 <span class="comment">//  ppFrameHierarchy</span>
00795 <span class="comment">//      Returns root node pointer of the loaded frame hierarchy</span>
00796 <span class="comment">//  ppAnimController</span>
00797 <span class="comment">//      Returns pointer to an animation controller corresponding to animation</span>
00798 <span class="comment">//      in the .X file. This is created with default max tracks and events</span>
00799 <span class="comment">//</span>
00800 <span class="comment">//----------------------------------------------------------------------------</span>
00801 HRESULT WINAPI 
00802 D3DXLoadMeshHierarchyFromXA
00803     (
00804     LPCSTR Filename,
00805     DWORD MeshOptions,
00806     LPDIRECT3DDEVICE9 pD3DDevice,
00807     LPD3DXALLOCATEHIERARCHY pAlloc,
00808     LPD3DXLOADUSERDATA pUserDataLoader, 
00809     LPD3DXFRAME *ppFrameHierarchy,
00810     LPD3DXANIMATIONCONTROLLER *ppAnimController
00811     );
00812 
00813 HRESULT WINAPI 
00814 D3DXLoadMeshHierarchyFromXW
00815     (
00816     LPCWSTR Filename,
00817     DWORD MeshOptions,
00818     LPDIRECT3DDEVICE9 pD3DDevice,
00819     LPD3DXALLOCATEHIERARCHY pAlloc,
00820     LPD3DXLOADUSERDATA pUserDataLoader, 
00821     LPD3DXFRAME *ppFrameHierarchy,
00822     LPD3DXANIMATIONCONTROLLER *ppAnimController
00823     );
00824 
00825 <span class="preprocessor">#ifdef UNICODE</span>
00826 <span class="preprocessor"></span><span class="preprocessor">#define D3DXLoadMeshHierarchyFromX D3DXLoadMeshHierarchyFromXW</span>
00827 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00828 <span class="preprocessor"></span><span class="preprocessor">#define D3DXLoadMeshHierarchyFromX D3DXLoadMeshHierarchyFromXA</span>
00829 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00830 <span class="preprocessor"></span>
00831 HRESULT WINAPI 
00832 D3DXLoadMeshHierarchyFromXInMemory
00833     (
00834     LPCVOID Memory,
00835     DWORD SizeOfMemory,
00836     DWORD MeshOptions,
00837     LPDIRECT3DDEVICE9 pD3DDevice,
00838     LPD3DXALLOCATEHIERARCHY pAlloc,
00839     LPD3DXLOADUSERDATA pUserDataLoader, 
00840     LPD3DXFRAME *ppFrameHierarchy,
00841     LPD3DXANIMATIONCONTROLLER *ppAnimController
00842     );
00843 
00844 <span class="comment">//----------------------------------------------------------------------------</span>
00845 <span class="comment">// D3DXSaveMeshHierarchyToFile:</span>
00846 <span class="comment">// ----------------------------</span>
00847 <span class="comment">// Creates a .X file and saves the mesh hierarchy and corresponding animations</span>
00848 <span class="comment">// in it</span>
00849 <span class="comment">//</span>
00850 <span class="comment">// Parameters:</span>
00851 <span class="comment">//  Filename</span>
00852 <span class="comment">//      Name of the .X file</span>
00853 <span class="comment">//  XFormat</span>
00854 <span class="comment">//      Format of the .X file (text or binary, compressed or not, etc)</span>
00855 <span class="comment">//  pFrameRoot</span>
00856 <span class="comment">//      Root node of the hierarchy to be saved</span>
00857 <span class="comment">//  pAnimController</span>
00858 <span class="comment">//      The animation controller whose animation sets are to be stored</span>
00859 <span class="comment">//  pUserDataSaver</span>
00860 <span class="comment">//      Application provided interface to allow adding of user data to</span>
00861 <span class="comment">//        data objects saved to .X file</span>
00862 <span class="comment">//</span>
00863 <span class="comment">//----------------------------------------------------------------------------</span>
00864 HRESULT WINAPI 
00865 D3DXSaveMeshHierarchyToFileA
00866     (
00867     LPCSTR Filename,
00868     DWORD XFormat,
00869     CONST D3DXFRAME *pFrameRoot, 
00870     LPD3DXANIMATIONCONTROLLER pAnimcontroller,
00871     LPD3DXSAVEUSERDATA pUserDataSaver
00872     );
00873 
00874 HRESULT WINAPI 
00875 D3DXSaveMeshHierarchyToFileW
00876     (
00877     LPCWSTR Filename,
00878     DWORD XFormat,
00879     CONST D3DXFRAME *pFrameRoot, 
00880     LPD3DXANIMATIONCONTROLLER pAnimController,
00881     LPD3DXSAVEUSERDATA pUserDataSaver
00882     );
00883 
00884 <span class="preprocessor">#ifdef UNICODE</span>
00885 <span class="preprocessor"></span><span class="preprocessor">#define D3DXSaveMeshHierarchyToFile D3DXSaveMeshHierarchyToFileW</span>
00886 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00887 <span class="preprocessor"></span><span class="preprocessor">#define D3DXSaveMeshHierarchyToFile D3DXSaveMeshHierarchyToFileA</span>
00888 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00889 <span class="preprocessor"></span>
00890 <span class="comment">//----------------------------------------------------------------------------</span>
00891 <span class="comment">// D3DXFrameDestroy:</span>
00892 <span class="comment">// -----------------</span>
00893 <span class="comment">// Destroys the subtree of frames under the root, including the root</span>
00894 <span class="comment">//</span>
00895 <span class="comment">// Parameters:</span>
00896 <span class="comment">//  pFrameRoot</span>
00897 <span class="comment">//      Pointer to the root node</span>
00898 <span class="comment">//  pAlloc</span>
00899 <span class="comment">//      Allocation interface used to de-allocate nodes of the frame hierarchy</span>
00900 <span class="comment">//</span>
00901 <span class="comment">//----------------------------------------------------------------------------</span>
00902 HRESULT WINAPI
00903 D3DXFrameDestroy
00904     (
00905     LPD3DXFRAME pFrameRoot,
00906     LPD3DXALLOCATEHIERARCHY pAlloc
00907     );
00908 
00909 <span class="comment">//----------------------------------------------------------------------------</span>
00910 <span class="comment">// D3DXFrameAppendChild:</span>
00911 <span class="comment">// ---------------------</span>
00912 <span class="comment">// Add a child frame to a frame</span>
00913 <span class="comment">//</span>
00914 <span class="comment">// Parameters:</span>
00915 <span class="comment">//  pFrameParent</span>
00916 <span class="comment">//      Pointer to the parent node</span>
00917 <span class="comment">//  pFrameChild</span>
00918 <span class="comment">//      Pointer to the child node</span>
00919 <span class="comment">//</span>
00920 <span class="comment">//----------------------------------------------------------------------------</span>
00921 HRESULT WINAPI 
00922 D3DXFrameAppendChild
00923     (
00924     LPD3DXFRAME pFrameParent,
00925     CONST D3DXFRAME *pFrameChild
00926     );
00927 
00928 <span class="comment">//----------------------------------------------------------------------------</span>
00929 <span class="comment">// D3DXFrameFind:</span>
00930 <span class="comment">// --------------</span>
00931 <span class="comment">// Finds a frame with the given name.  Returns NULL if no frame found.</span>
00932 <span class="comment">//</span>
00933 <span class="comment">// Parameters:</span>
00934 <span class="comment">//  pFrameRoot</span>
00935 <span class="comment">//      Pointer to the root node</span>
00936 <span class="comment">//  Name</span>
00937 <span class="comment">//      Name of frame to find</span>
00938 <span class="comment">//</span>
00939 <span class="comment">//----------------------------------------------------------------------------</span>
00940 LPD3DXFRAME WINAPI 
00941 D3DXFrameFind
00942     (
00943     CONST D3DXFRAME *pFrameRoot,
00944     LPCSTR Name
00945     );
00946 
00947 <span class="comment">//----------------------------------------------------------------------------</span>
00948 <span class="comment">// D3DXFrameRegisterNamedMatrices:</span>
00949 <span class="comment">// -------------------------------</span>
00950 <span class="comment">// Finds all frames that have non-null names and registers each of those frame</span>
00951 <span class="comment">// matrices to the given animation controller</span>
00952 <span class="comment">//</span>
00953 <span class="comment">// Parameters:</span>
00954 <span class="comment">//  pFrameRoot</span>
00955 <span class="comment">//      Pointer to the root node</span>
00956 <span class="comment">//  pAnimController</span>
00957 <span class="comment">//      Pointer to the animation controller where the matrices are registered</span>
00958 <span class="comment">//</span>
00959 <span class="comment">//----------------------------------------------------------------------------</span>
00960 HRESULT WINAPI
00961 D3DXFrameRegisterNamedMatrices
00962     (
00963     LPD3DXFRAME pFrameRoot,
00964     LPD3DXANIMATIONCONTROLLER pAnimController
00965     );
00966 
00967 <span class="comment">//----------------------------------------------------------------------------</span>
00968 <span class="comment">// D3DXFrameNumNamedMatrices:</span>
00969 <span class="comment">// --------------------------</span>
00970 <span class="comment">// Counts number of frames in a subtree that have non-null names </span>
00971 <span class="comment">//</span>
00972 <span class="comment">// Parameters:</span>
00973 <span class="comment">//  pFrameRoot</span>
00974 <span class="comment">//      Pointer to the root node of the subtree</span>
00975 <span class="comment">// Return Value:</span>
00976 <span class="comment">//      Count of frames</span>
00977 <span class="comment">//</span>
00978 <span class="comment">//----------------------------------------------------------------------------</span>
00979 UINT WINAPI
00980 D3DXFrameNumNamedMatrices
00981     (
00982     CONST D3DXFRAME *pFrameRoot
00983     );
00984 
00985 <span class="comment">//----------------------------------------------------------------------------</span>
00986 <span class="comment">// D3DXFrameCalculateBoundingSphere:</span>
00987 <span class="comment">// ---------------------------------</span>
00988 <span class="comment">// Computes the bounding sphere of all the meshes in the frame hierarchy.</span>
00989 <span class="comment">//</span>
00990 <span class="comment">// Parameters:</span>
00991 <span class="comment">//  pFrameRoot</span>
00992 <span class="comment">//      Pointer to the root node</span>
00993 <span class="comment">//  pObjectCenter</span>
00994 <span class="comment">//      Returns the center of the bounding sphere</span>
00995 <span class="comment">//  pObjectRadius</span>
00996 <span class="comment">//      Returns the radius of the bounding sphere</span>
00997 <span class="comment">//</span>
00998 <span class="comment">//----------------------------------------------------------------------------</span>
00999 HRESULT WINAPI
01000 D3DXFrameCalculateBoundingSphere
01001     (
01002     CONST D3DXFRAME *pFrameRoot,       
01003     LPD3DXVECTOR3 pObjectCenter,  
01004     FLOAT *pObjectRadius          
01005     );
01006 
01007 
01008 <span class="comment">//----------------------------------------------------------------------------</span>
01009 <span class="comment">// D3DXCreateKeyframedAnimationSet:</span>
01010 <span class="comment">// --------------------------------</span>
01011 <span class="comment">// This function creates a compressable keyframed animations set interface.</span>
01012 <span class="comment">// </span>
01013 <span class="comment">// Parameters:</span>
01014 <span class="comment">//  pName</span>
01015 <span class="comment">//      Name of the animation set</span>
01016 <span class="comment">//  TicksPerSecond</span>
01017 <span class="comment">//      Number of keyframe ticks that elapse per second</span>
01018 <span class="comment">//  Playback</span>
01019 <span class="comment">//      Playback mode of keyframe looping</span>
01020 <span class="comment">//  NumAnimations</span>
01021 <span class="comment">//      Number of SRT animations</span>
01022 <span class="comment">//  NumCallbackKeys</span>
01023 <span class="comment">//      Number of callback keys</span>
01024 <span class="comment">//  pCallbackKeys</span>
01025 <span class="comment">//      Array of callback keys</span>
01026 <span class="comment">//  ppAnimationSet</span>
01027 <span class="comment">//      Returns the animation set interface</span>
01028 <span class="comment">// </span>
01029 <span class="comment">//-----------------------------------------------------------------------------     </span>
01030 HRESULT WINAPI
01031 D3DXCreateKeyframedAnimationSet
01032     (
01033     LPCSTR pName,                               
01034     DOUBLE TicksPerSecond,
01035     D3DXPLAYBACK_TYPE Playback,
01036     UINT NumAnimations,                         
01037     UINT NumCallbackKeys,                       
01038     CONST D3DXKEY_CALLBACK *pCallbackKeys,           
01039     LPD3DXKEYFRAMEDANIMATIONSET *ppAnimationSet 
01040     );
01041 
01042 
01043 <span class="comment">//----------------------------------------------------------------------------</span>
01044 <span class="comment">// D3DXCreateCompressedAnimationSet:</span>
01045 <span class="comment">// --------------------------------</span>
01046 <span class="comment">// This function creates a compressed animations set interface from </span>
01047 <span class="comment">// compressed data.</span>
01048 <span class="comment">// </span>
01049 <span class="comment">// Parameters:</span>
01050 <span class="comment">//  pName</span>
01051 <span class="comment">//      Name of the animation set</span>
01052 <span class="comment">//  TicksPerSecond</span>
01053 <span class="comment">//      Number of keyframe ticks that elapse per second</span>
01054 <span class="comment">//  Playback</span>
01055 <span class="comment">//      Playback mode of keyframe looping</span>
01056 <span class="comment">//  pCompressedData</span>
01057 <span class="comment">//      Compressed animation SRT data</span>
01058 <span class="comment">//  NumCallbackKeys</span>
01059 <span class="comment">//      Number of callback keys</span>
01060 <span class="comment">//  pCallbackKeys</span>
01061 <span class="comment">//      Array of callback keys</span>
01062 <span class="comment">//  ppAnimationSet</span>
01063 <span class="comment">//      Returns the animation set interface</span>
01064 <span class="comment">// </span>
01065 <span class="comment">//-----------------------------------------------------------------------------     </span>
01066 HRESULT WINAPI
01067 D3DXCreateCompressedAnimationSet
01068     (
01069     LPCSTR pName,                               
01070     DOUBLE TicksPerSecond,
01071     D3DXPLAYBACK_TYPE Playback,
01072     LPD3DXBUFFER pCompressedData,                         
01073     UINT NumCallbackKeys,                       
01074     CONST D3DXKEY_CALLBACK *pCallbackKeys,           
01075     LPD3DXCOMPRESSEDANIMATIONSET *ppAnimationSet 
01076     );
01077 
01078 
01079 <span class="comment">//----------------------------------------------------------------------------</span>
01080 <span class="comment">// D3DXCreateAnimationController:</span>
01081 <span class="comment">// ------------------------------</span>
01082 <span class="comment">// This function creates an animation controller object.</span>
01083 <span class="comment">//</span>
01084 <span class="comment">// Parameters:</span>
01085 <span class="comment">//  MaxNumMatrices</span>
01086 <span class="comment">//      Maximum number of matrices that can be animated</span>
01087 <span class="comment">//  MaxNumAnimationSets</span>
01088 <span class="comment">//      Maximum number of animation sets that can be played</span>
01089 <span class="comment">//  MaxNumTracks</span>
01090 <span class="comment">//      Maximum number of animation sets that can be blended</span>
01091 <span class="comment">//  MaxNumEvents</span>
01092 <span class="comment">//      Maximum number of outstanding events that can be scheduled at any given time</span>
01093 <span class="comment">//  ppAnimController</span>
01094 <span class="comment">//      Returns the animation controller interface</span>
01095 <span class="comment">//</span>
01096 <span class="comment">//-----------------------------------------------------------------------------     </span>
01097 HRESULT WINAPI
01098 D3DXCreateAnimationController
01099     (
01100     UINT MaxNumMatrices,                       
01101     UINT MaxNumAnimationSets,                  
01102     UINT MaxNumTracks,                         
01103     UINT MaxNumEvents,                         
01104     LPD3DXANIMATIONCONTROLLER *ppAnimController
01105     );
01106 
01107 
01108 <span class="preprocessor">#ifdef __cplusplus</span>
01109 <span class="preprocessor"></span>}
01110 <span class="preprocessor">#endif //__cplusplus</span>
01111 <span class="preprocessor"></span>
01112 <span class="preprocessor">#endif //__D3DX9ANIM_H__</span>
01113 <span class="preprocessor"></span>
01114 
</pre></div><hr><address style="align: right;"><small>
Generated on Tue Jun 13 11:14:34 2006 for gRenderDX9 by <a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 width=110 height=53>
</a> 1.3.1 using KingsTools</small></address>
</body>
</html>
